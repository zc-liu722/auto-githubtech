<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Future Insight | æœªæ¥æ´è§</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        bg: '#0F0F10',
                        card: 'rgba(26, 26, 28, 0.7)', 
                        morandiGreen: '#8FA998',
                        morandiBlue: '#7D93A6',
                        morandiPink: '#BCAaa4',
                        textMain: '#E0E0E0',
                        textDim: '#858585'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes float {
            0% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(40px, -60px) scale(1.1); }
            66% { transform: translate(-30px, 30px) scale(0.9); }
            100% { transform: translate(0, 0) scale(1); }
        }

        body { 
            background-color: #0F0F10; 
            color: #E0E0E0; 
            font-family: 'Inter', sans-serif;
            position: relative;
            overflow-x: hidden;
        }

        .bg-glow-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            filter: blur(120px);
            opacity: 0.35;
        }

        .glow-circle {
            position: absolute;
            border-radius: 50%;
            animation: float 18s infinite ease-in-out;
        }

        .tech-card { 
            transition: all 0.4s cubic-bezier(0.25, 1, 0.5, 1); 
            border: 1px solid rgba(255,255,255,0.06); 
            backdrop-filter: blur(10px);
        }
        .tech-card:hover { 
            transform: translateY(-5px); 
            border-color: #7D93A6; 
            box-shadow: 0 15px 40px rgba(0,0,0,0.6); 
            background: rgba(255, 255, 255, 0.03);
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0F0F10; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }

        #history-sidebar {
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        #history-archive-list::-webkit-scrollbar { width: 4px; }
        #history-archive-list::-webkit-scrollbar-thumb { background: #444; border-radius: 10px; }
    </style>
</head>
<body class="min-h-screen p-8">

    <div class="bg-glow-container">
        <div class="glow-circle" style="width: 50vw; height: 50vw; background: #8FA998; top: -10%; left: -5%; animation-delay: 0s;"></div>
        <div class="glow-circle" style="width: 45vw; height: 45vw; background: #7D93A6; bottom: -5%; right: -5%; animation-delay: -4s;"></div>
        <div class="glow-circle" style="width: 35vw; height: 35vw; background: #BCAaa4; top: 20%; left: 30%; animation-delay: -8s;"></div>
    </div>

    <header class="max-w-7xl mx-auto mb-12 border-b border-gray-800 pb-6 flex justify-between items-end relative z-10">
        <div>
            <h1 class="text-4xl font-bold tracking-tight text-white mb-2">FUTURE <span class="text-morandiBlue">INSIGHT</span></h1>
            <p class="text-morandiGreen text-sm">æ¯æ—¥ AI ä¸å‰æ²¿æŠ€æœ¯æƒ…æŠ¥ç«™</p>
        </div>
        <div class="flex items-center space-x-4">
            <button onclick="toggleHistory()" class="text-morandiBlue border border-morandiBlue/30 px-4 py-1 rounded-full text-xs hover:bg-morandiBlue hover:text-white transition-all">
                ğŸ“œ æŸ¥çœ‹å†å²å­˜æ¡£
            </button>
            <div id="update-date" class="text-textDim text-sm font-mono">Loading...</div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-12 relative z-10">
        <section>
            <h2 class="text-2xl font-bold mb-6 flex items-center">
                <span class="w-2 h-8 bg-morandiBlue mr-3 rounded-full shadow-[0_0_15px_#7D93A6]"></span>
                æœ¬æœˆæ–°æ˜Ÿ (Trending)
            </h2>
            <div id="trending-list" class="space-y-6"></div>
        </section>

        <section>
            <h2 class="text-2xl font-bold mb-6 flex items-center">
                <span class="w-2 h-8 bg-morandiPink mr-3 rounded-full shadow-[0_0_15px_#BCAaa4]"></span>
                å†å²æ®¿å ‚ (Hall of Fame)
            </h2>
            <div id="all-time-list" class="space-y-6"></div>
        </section>
    </main>

    <div id="modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm hidden flex justify-center items-center z-[70] p-4">
        <div class="bg-[#1A1A1C] w-full max-w-3xl max-h-[90vh] overflow-y-auto rounded-xl border border-gray-700 p-8 relative shadow-2xl">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-white text-2xl">&times;</button>
            <div id="modal-content"></div>
        </div>
    </div>

    <div id="history-sidebar" class="fixed inset-y-0 right-0 w-full md:w-96 bg-[#1A1A1C]/95 backdrop-blur-xl border-l border-white/10 z-[60] transform translate-x-full shadow-2xl">
        <div class="p-6 h-full flex flex-col">
            <div class="flex justify-between items-center mb-8 border-b border-white/10 pb-4">
                <h3 class="text-xl font-bold text-morandiBlue tracking-widest uppercase">é¡¹ç›®å­˜æ¡£ Archive</h3>
                <button onclick="toggleHistory()" class="text-textDim hover:text-white text-3xl">&times;</button>
            </div>
            <div id="history-archive-list" class="flex-1 overflow-y-auto space-y-4">
                </div>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ–åŠ è½½æ•°æ®
        fetch('./data.json')
            .then(response => response.json())
            .then(data => {
                document.getElementById('update-date').innerText = `Last Updated: ${data.date}`;
                renderList('trending-list', data.trending);
                renderList('all-time-list', data.all_time);
            })
            .catch(error => console.error('Error loading data:', error));

        function renderList(containerId, items) {
            const container = document.getElementById(containerId);
            if(!items || items.length === 0) {
                container.innerHTML = '<p class="text-textDim italic">æš‚æ— æ•°æ®</p>';
                return;
            }
            items.forEach((item) => {
                const info = item.repo_info;
                const ai = item.analysis;
                
                const card = document.createElement('div');
                card.className = 'tech-card bg-card p-6 rounded-lg cursor-pointer';
                card.onclick = () => openModal(item);
                
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="text-xl font-bold text-white">${ai.title_cn}</h3>
                        <span class="text-xs font-mono text-morandiGreen border border-morandiGreen px-2 py-1 rounded">â˜… ${info.stargazers_count}</span>
                    </div>
                    <p class="text-gray-400 text-sm mb-4 line-clamp-2">${ai.one_liner}</p>
                    <div class="flex flex-wrap gap-2">
                        ${ai.tags.map(tag => `<span class="text-xs bg-gray-800 text-morandiBlue px-2 py-1 rounded-full">#${tag}</span>`).join('')}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function openModal(item) {
            const modal = document.getElementById('modal');
            const content = document.getElementById('modal-content');
            const ai = item.analysis;

            // --- æ–°å¢ï¼šä¸€ä¸ªå†…éƒ¨å°å·¥å…·ï¼Œç”¨æ¥ç¡®ä¿å†…å®¹æ˜¯æ–‡å­— ---
            const formatText = (text) => {
                if (typeof text === 'object' && text !== null) {
                    // å¦‚æœ AI è¿˜æ˜¯è¿”å›äº†å¯¹è±¡ï¼Œå°±æŠŠå¯¹è±¡é‡Œçš„æ‰€æœ‰å€¼ä¸²è”èµ·æ¥æ˜¾ç¤º
                    return Object.values(text).join(' ');
                }
                return text || 'æš‚æ— å†…å®¹';
            };

            content.innerHTML = `
                <h2 class="text-3xl font-bold text-white mb-2">${ai.title_cn}</h2>
                <p class="text-morandiGreen font-mono mb-6 text-sm uppercase tracking-wider">${item.repo_info.full_name}</p>
                
                <div class="space-y-6 text-gray-300">
                    <div class="bg-gray-900/50 p-4 rounded-lg border-l-4 border-morandiBlue">
                        <h4 class="font-bold text-white mb-2 uppercase text-xs tracking-widest text-morandiBlue">ğŸ¯ ä¸€å¥è¯ä»‹ç»</h4>
                        <p class="text-lg">${formatText(ai.one_liner)}</p>
                    </div>

                    <div>
                        <h4 class="text-sm font-bold text-white mb-2 uppercase tracking-widest border-b border-white/10 pb-1">ğŸ§  æ ¸å¿ƒåŸç† (Principle)</h4>
                        <p class="leading-relaxed">${formatText(ai.deep_dive.principle)}</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white/5 p-4 rounded-lg">
                            <h4 class="font-bold text-white mb-2 uppercase text-xs tracking-widest text-morandiGreen">ğŸš€ åº”ç”¨åœºæ™¯</h4>
                            <p class="text-sm leading-relaxed">${formatText(ai.deep_dive.application)}</p>
                        </div>
                        <div class="bg-white/5 p-4 rounded-lg">
                            <h4 class="font-bold text-white mb-2 uppercase text-xs tracking-widest text-morandiGreen">ğŸ’¡ æœºä¼š & çµæ„Ÿ</h4>
                            <p class="text-sm leading-relaxed">${formatText(ai.deep_dive.opportunity)}</p>
                        </div>
                    </div>

                    <div class="bg-morandiPink/5 p-4 rounded-lg border border-morandiPink/20">
                        <h4 class="font-bold text-morandiPink mb-2 uppercase text-xs tracking-widest">ğŸ¤” æ‰¹åˆ¤æ€§æ€è€ƒ</h4>
                        <p class="text-sm italic text-gray-400 leading-relaxed">${formatText(ai.deep_dive.critical)}</p>
                    </div>

                    <a href="${item.repo_info.html_url}" target="_blank" class="block w-full text-center bg-white text-black font-bold py-4 rounded-xl mt-8 hover:bg-morandiBlue hover:text-white transition-all shadow-lg">
                        EXPLORE GITHUB SOURCE
                    </a>
                </div>
            `;
            modal.classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('modal').classList.add('hidden');
        }

        // å†å²ä¾§è¾¹æ é€»è¾‘
        let isHistoryOpen = false;

        function toggleHistory() {
            const sidebar = document.getElementById('history-sidebar');
            isHistoryOpen = !isHistoryOpen;
            
            if (isHistoryOpen) {
                sidebar.classList.remove('translate-x-full');
                loadHistoryData();
            } else {
                sidebar.classList.add('translate-x-full');
            }
        }

        function loadHistoryData() {
            const listContainer = document.getElementById('history-archive-list');
            listContainer.innerHTML = '<p class="text-center text-textDim py-10 animate-pulse">æ­£åœ¨è°ƒå–è®°å¿†åº“ Archive...</p>';

            fetch('./history.json')
                .then(res => res.json())
                .then(data => {
                    listContainer.innerHTML = '';
                    if (!data || data.length === 0) {
                        listContainer.innerHTML = '<p class="text-center text-textDim py-10">æš‚æ— å†å²å­˜æ¡£</p>';
                        return;
                    }
                    data.forEach(item => {
                        const div = document.createElement('div');
                        div.className = 'p-4 rounded-lg bg-white/5 border border-white/5 hover:border-morandiBlue/50 cursor-pointer transition-all group';
                        div.onclick = () => {
                            openModal(item);
                            toggleHistory();
                        };
                        div.innerHTML = `
                            <div class="text-[10px] text-morandiGreen mb-1 font-mono uppercase opacity-60 tracking-tighter">${item.repo_info.name}</div>
                            <div class="text-sm font-bold text-white group-hover:text-morandiBlue transition-colors">${item.analysis.title_cn}</div>
                        `;
                        listContainer.appendChild(div);
                    });
                })
                .catch(() => {
                    listContainer.innerHTML = '<p class="text-center text-morandiPink py-10 text-xs italic">å­˜æ¡£æ–‡ä»¶ç”Ÿæˆä¸­ï¼Œè¯·åœ¨ä¸‹æ¬¡æŠ“å–åæŸ¥çœ‹ã€‚</p>';
                });
        }
    </script>
</body>
</html>